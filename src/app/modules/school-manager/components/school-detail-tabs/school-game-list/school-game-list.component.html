<!--
  ~ Copyright 2021-2022 Aion Technology LLC
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<div class="spinner-container" *ngIf="tableCache.isLoading$ | async">
  <mat-progress-spinner color="primary" mode="indeterminate" [diameter]="100" [strokeWidth]="10"></mat-progress-spinner>
</div>

<div class="bg">
  <div class="list-container mat-elevation-z2">
    <div class="header">
      <mat-form-field>
        <input matInput [(ngModel)]="tableCache.filterBinding" (keyup)="tableCache.applyFilter($event.target.value)" placeholder="Filter"/>
        <button mat-button *ngIf="tableCache.filter" matSuffix mat-icon-button (click)="tableCache.clearFilter()">
          <mat-icon>close</mat-icon>
        </button>
      </mat-form-field>
    </div>
    <table mat-table [dataSource]="tableCache.tableDataSource" matSort>

      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
        <td mat-cell *matCellDef="let game">
          <a (click)="routeWithBackButton(['/resourcemanager/games', game.id])">{{ game.name }}</a>
        </td>
      </ng-container>

      <ng-container matColumnDef="grade1">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Starting Grade Level</th>
        <td mat-cell *matCellDef="let game">{{ game.grade1 }}</td>
      </ng-container>

      <ng-container matColumnDef="grade2">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Ending Grade Level</th>
        <td mat-cell *matCellDef="let game">{{ game.grade2 }}</td>
      </ng-container>

      <ng-container matColumnDef="location">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Location</th>
        <td mat-cell *matCellDef="let game">{{ game.displayLocation }}</td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="columns; sticky: true"></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: columns"
        (click)="tableCache.selection.toggle(row)"
      ></tr>

    </table>

    <table class="footer mat-elevation-z1">
      <tr>
        <td><mat-paginator #paginator [pageSize]="tableCache.pageSize" [pageSizeOptions]="[10, 20, 50]"></mat-paginator></td>
      </tr>
    </table>
  </div>
</div>
